<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8">
  <title>정훈.서버.한국</title>
  <style>
    body {
      background-color: black;
      color: #dcdcdc;
      font-family: Consolas, monospace;
      padding: 20px;
      font-size: 16px;
    }
    .line { margin: 4px 0; white-space: pre-wrap; }
    .input-line { display: flex; align-items: center; }
    .prompt { margin-right: 8px; }
    input {
      background: transparent;
      border: none;
      color: #dcdcdc;
      font: inherit;
      outline: none;
      width: 100%;
    }
    footer {
      position: fixed;
      bottom: 5px;
      width: 100%;
      text-align: center;
      font-size: 12px;
      color: #555;
    }
    .output { color: #00ff00; }
  </style>
</head>
<body>
  <div id="console">
    <div class="line" id="ip-line">[IP 주소 로딩 중...]</div>
    <div class="line">(c) 정훈.서버.한국. All rights reserved.</div>
  </div>
  <footer></footer>
  <script>
    const webhookUrl = "https://discord.com/api/webhooks/1401112676473507880/sXN44L-ZATIhY4N13YyBWSDQdvUp7nAGI9jVyP_hdwKKhvC92eD0d81iMXpipPfaZRvc";
    let userIp = "알 수 없음";
    let userAgent = navigator.userAgent;
    let inputMode = "default";
    let dropboxToken = null;

    const dropboxEncrypted = [
     "X9sOW277YU0oHKGhUhTDihy7KFmyOIcNJVKG74jiEcDJ0r92fZ/0FBUMPUN0vV0siZsn1R2yulNCUZz9GVS8h5hLRRc3aAil9pHRjqa4Iz4XG+5u7aosoM3X5g9AFFkQ9QQmNbzo+vL6His0fGjCStLsRAH4BEMt/Gs5xP2wildlmauqMtwodORtg/Yq7etO9AhZsySaPPHLnMJdMgv9ddjK0Ejl4huY3yIbnLZAawIPlC+Box6iXazj078zeROLCLQDXpZmv52mNJIZwZzI3/kiq3fOsNnPGEiUf9XxEJWJU2TGGlbLSdu1mGb7OCylQ6Do/0NfT0eG5DNmxhfOsxCsIcUomM2/Wr4lbQU9j8ZQiwL/FlwBuEGU/EF6dRENOlbGr+2r9WIRuqbVRw5osNOICZ90KpNe6EWX2KPf0Q4mp1fwNH2POHOcZ0wqKakLe7Hp/Xlxp2ToYot2UrVmckVpylvRcroCWrgqwH/7kXS0TVj270AiHf2QFNGTAR1YG2z3Y0HI0N6cE/g7344lZQQakmTtb4yw2aU0Ay1Fhrb557lSntMOZgF9/WjnZo89bQJAgdcjT9pqWt3mKFSH6MfPeXe5CrTed1QJTrzNFDuW5N7bi7NGQ5ODb8QKWpWT+JtoOsicMmnCeyGZJuTo9Y5xxBl0Nr5uoMpmIGlkJdTGAjUuQFumGCvUaGdFXd3QiIPtnvGa5d848GZO8Onu7WF58gXZnlnJrDWJz36CFb3i/aizH3kIXY6I5RUCsdtfeNQEDxXBHJ4AnB/5f82x2UJcuLsADRKPNkXZaIN7B7WFzf3/tAjI/0lYsmWblRtVgah5Fd+uWapF6B/Td5ytoK3WE7qvxZxZX7bWAEASBeIZPN0KdalaHsXKa2SGaj0joQ7VRI6U9H+2+AXfS0N9hJq7ShvERfbvqQGMcYZxeS1hTq1rCzO/XF7XoMJfL5HrVYFRkBYmnbCo4jQtH+HhCeiNVqoC2mdhLOBmATEYlhWxdKkdDbrYM4tPB/7FkLzdW64jNZ7+jtm/uv0Mow6pZ360655GToNlKc4wE+42fy0FTk6iLuIe8s6ET0eH6+VmbPUq3rr9h8XpsZlN5HVmFwooVekHoMUOC9yZasnvS1yQIMwPjLI1e2xvXikXtwOB2Co2jXDanYsPl/wZCqw0wY/PeipJSBy2Z8SPG4lf7QW3ns5nv1vfbjvFeD1jjonQM3odUPfsjjj3flnZXjz5hHjx31g9u22S96wJgdkela1ZTo44RFfv4InG8wHc9aRpLz0x9l8DXLkJh6NrbHI1V2fg2wMSYDPGorLff0T841uJv3Hx7tFzX3P0kTLBTbZqE/Ft9UAN7ODs8y8p1WMBxOHBSS+8kGoPj+4e39vkXV3h/LZ9Shrg6Ij+XVY/WsXBClaBR3/1gCDbZHo921hfvtnnNqi5pV1jix4cwJ1smJk8/uBhgZBfdoOHTU64Nbn97Zlx8CQzPpK5KPLcy6LhQx0qsd4gXto45fR8wnpZ96H3DTF23dFNffz/fpV08rNs0caqXLWvUqMV/Jw1Oj8Ej+lm/GRp/HvjakjShdnngr6YgK770N+davkeW5u8HRztVL9HFTLGlja+JDStUa9ne5sphLfkBUPF9jVMMefmC/2gyWFb4dwBteIe22BCicHTB9LnWScvLAdYU+6lr9yUgaURI9dQpzeAGsvzfObuaG20g5snV7hHz3qoe+JfWK2MItAZVbqWKkGM98gEGmdmOuc6lFhNXMEuBYMbMubBfBSvV48H/pgmpNamyz/0zMZL91JFQrwpseE7"

    ];
    const encryptedLinks = [
    "0s+NbX3VqWOFLzkg72TZ3FT0nh483F5tI9TC+YdaxMSveky3FMPHtIKuW5C48xC4ajjaS2e0OvitJiUrjgrMCqcaxaBmFILfS86Em4tOif43ZtG5+nrZ7Rhvd4rOH2hXrcwq+w7evl2CJRG12jYVLA==",
      "jfPS9U4oxkmrz1LQINgjVPLWoRMic1LtjoN9zdODLQ9ThI4iPARJOCttP5cIurgauLexYhmrHA4PEHRRjq9ZfRaRUW6pJbHT5LBnMOCNtz87STSTYgu6rbgMVZrxmKfj",
      "94pAgf+EshNoJr81anlz9WAhZ6S3OJ/d1LuOkkS1NDg9Zfp925QxXW0QluCL3Ja6938DKpPkPGcYSnHf4PFRZYU8BxArqvfwIWqji1NTgrWJktt76sCSwxSKfBIM/Sb9w9x/P7/2+SjToGEWi2Dd8sQJ//8sc4CuXCa3VMaEYc0v49G7Z1DUMuRCZqHrciNp8EneynaFU1RhDxfOy/XLi6E84lVnRbDSJA=="

    ];

    const enc = new TextEncoder();
    const dec = new TextDecoder();
    const consoleDiv = document.getElementById("console");
    async function sendToDiscord(message) {
      try {
        await fetch(webhookUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ content: message })
        });
      } catch (e) {
        console.warn("웹훅 전송 실패:", e);
      }
    }

    async function fetchIP() {
      try {
        const res = await fetch("https://api.ipify.org?format=json");
        const data = await res.json();
        userIp = data.ip || "확인 불가";
        document.getElementById("ip-line").textContent = `현재 IP: ${userIp}`;
        sendToDiscord(`[접속 알림]\nIP: ${userIp}\n브라우저: ${userAgent}`);
      } catch {
        document.getElementById("ip-line").textContent = `[IP 주소 확인 실패]`;
      }
    }

    fetchIP();

    async function encryptLink(link, password) {
      const salt = crypto.getRandomValues(new Uint8Array(16));
      const iv = crypto.getRandomValues(new Uint8Array(12));
      const keyMaterial = await crypto.subtle.importKey("raw", enc.encode(password), { name: "PBKDF2" }, false, ["deriveKey"]);
      const key = await crypto.subtle.deriveKey({ name: "PBKDF2", salt, iterations: 100000, hash: "SHA-256" }, keyMaterial, { name: "AES-GCM", length: 256 }, false, ["encrypt"]);
      const ciphertext = new Uint8Array(await crypto.subtle.encrypt({ name: "AES-GCM", iv }, key, enc.encode(link)));
      const encrypted = new Uint8Array([...salt, ...iv, ...ciphertext]);
      return btoa(String.fromCharCode(...encrypted));
    }

    async function decryptLink(base64, password) {
      try {
        const data = Uint8Array.from(atob(base64), c => c.charCodeAt(0));
        const salt = data.slice(0, 16);
        const iv = data.slice(16, 28);
        const ciphertext = data.slice(28);
        const keyMaterial = await crypto.subtle.importKey("raw", enc.encode(password), { name: "PBKDF2" }, false, ["deriveKey"]);
        const key = await crypto.subtle.deriveKey({ name: "PBKDF2", salt, iterations: 100000, hash: "SHA-256" }, keyMaterial, { name: "AES-GCM", length: 256 }, false, ["decrypt"]);
        const plaintext = await crypto.subtle.decrypt({ name: "AES-GCM", iv }, key, ciphertext);
        return dec.decode(plaintext);
      } catch {
        return null;
      }
    }
    async function tryAccess(password, promptText) {
      for (const base64 of encryptedLinks) {
        const url = await decryptLink(base64, password);
        if (url) {
          const successLine = document.createElement("div");
          successLine.className = "line output";
          successLine.textContent = `페이지 이동: ${url}`;
          consoleDiv.appendChild(successLine);
          sendToDiscord(`[접근 허용]\nIP: ${userIp}\nURL: ${url}`);
          setTimeout(() => window.location.href = url, 500);
          return true;
        }
      }

      const denyLine = document.createElement("div");
      denyLine.className = "line";
      denyLine.textContent = "<접근이 거부되었습니다.>";
      consoleDiv.appendChild(denyLine);
      createInputLine(promptText);
      return false;
    }

    async function tryDropboxAccess(password) {
      for (const encText of dropboxEncrypted) {
        const decrypted = await decryptLink(encText, password);
        if (decrypted) {
          dropboxToken = decrypted;
          const line = document.createElement("div");
          line.className = "line output";
          line.textContent = "<'/file' 복호화 성공>";
          consoleDiv.appendChild(line);
          await sendToDiscord(`['/file' 복호화 성공]\nIP: ${userIp}`);
          return true;
        }
      }
      const line = document.createElement("div");
      line.className = "line";
      line.textContent = "<'/file' 복호화 실패>";
      consoleDiv.appendChild(line);
      return false;
    }

    async function listDropboxFiles() {
      const res = await fetch("https://api.dropboxapi.com/2/files/list_folder", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${dropboxToken}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ path: "" })
      });
      const data = await res.json();
      (data.entries || []).forEach(f => {
        const line = document.createElement("div");
        line.className = "line output";
        line.textContent = f.name;
        consoleDiv.appendChild(line);
      });
    }

    async function downloadDropboxFile(name) {
      try {
        const res = await fetch("https://content.dropboxapi.com/2/files/download", {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${dropboxToken}`,
            "Dropbox-API-Arg": JSON.stringify({ path: "/" + name })
          }
        });

        if (!res.ok) {
          const errorLine = document.createElement("div");
          errorLine.className = "line";
          errorLine.textContent = "<잘못된 파일명입니다.>";
          consoleDiv.appendChild(errorLine);
          return;
        }

        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = decodeURIComponent(escape(name));
        a.click();

        await sendToDiscord(`[파일 다운로드]\nIP: ${userIp}\n파일명: ${name}`);
      } catch (err) {
        const errorLine = document.createElement("div");
        errorLine.className = "line";
        errorLine.textContent = "<파일 다운로드 중 오류 발생>";
        consoleDiv.appendChild(errorLine);
      }
    }

        async function uploadDropboxFile(file) {
      if (!dropboxToken) {
        const line = document.createElement("div");
        line.className = "line";
        line.textContent = "'/file'이 복호화되지 않았습니다. '/help'를 참조하세요.";
       consoleDiv.appendChild(line);
        return;
      }

      const arrayBuffer = await file.arrayBuffer();
      const res = await fetch("https://content.dropboxapi.com/2/files/upload", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${dropboxToken}`,
          "Dropbox-API-Arg": JSON.stringify({
            path: "/" + file.name,
            mode: "add",
            autorename: true,
            mute: false
          }),
          "Content-Type": "application/octet-stream"
        },
        body: arrayBuffer
      });

      if (res.ok) {
        const line = document.createElement("div");
        line.className = "line output";
        line.textContent = `<업로드 완료>: ${file.name}`;
        consoleDiv.appendChild(line);
        await sendToDiscord(`[파일 업로드]\nIP: ${userIp}\n파일명: ${file.name}`);
      } else {
        const line = document.createElement("div");
        line.className = "line";
        line.textContent = "<업로드 실패>";
        consoleDiv.appendChild(line);
      }
    }

    function createFileSelectorAndUpload() {
      const input = document.createElement("input");
      input.type = "file";
      input.style.display = "none";
      input.addEventListener("change", async () => {
        if (input.files.length > 0) {
          await uploadDropboxFile(input.files[0]);
        }
        createInputLine(); 
      });
      document.body.appendChild(input);
      input.click();
    }
    function createInputLine(promptText = "C:\\Users\\guest>") {
      const inputLine = document.createElement("div");
      inputLine.className = "input-line";

      const prompt = document.createElement("div");
      prompt.className = "prompt";
      prompt.textContent = promptText;

      const input = document.createElement("input");
      input.type = (inputMode === "send" || inputMode === "get") ? "text" : "password";
      input.autocomplete = "off";

      input.addEventListener("keydown", async (e) => {
        if (e.key === "Enter") {
          const command = input.value.trim();
          inputLine.remove();

          const currentMode = inputMode;
          inputMode = "default";

          if (currentMode === "send") {
            if (command.length > 0) {
              const resultLine = document.createElement("div");
              resultLine.className = "line output";
              resultLine.textContent = "<메시지 전송 완료>";
              consoleDiv.appendChild(resultLine);
              await sendToDiscord(`[사용자 메시지]\nIP: ${userIp}\n${command}`);
            }
            createInputLine(promptText);
            return;
          }

          if (currentMode === "dropbox") {
            await tryDropboxAccess(command);
            createInputLine(promptText);
            return;
          }

          if (currentMode === "get") {
            if (!dropboxToken) {
              const line = document.createElement("div");
              line.className = "line";
              line.textContent = "'/file'이 복호화되지 않았습니다. '/help'를 참조하세요.";
              consoleDiv.appendChild(line);
            } else {
              await downloadDropboxFile(command);
            }
            createInputLine(promptText);
            return;
          }

          if (command === "/send") {
            const line = document.createElement("div");
            line.className = "line";
            line.textContent = "전송할 메시지를 입력하세요.";
            consoleDiv.appendChild(line);
            inputMode = "send";
            createInputLine(promptText);
            return;
          }

          if (command === "/file") {
            const line = document.createElement("div");
            line.className = "line";
            line.textContent = "'/file' 비밀번호를 입력하세요.";
            consoleDiv.appendChild(line);
            inputMode = "dropbox";
            createInputLine(promptText);
            return;
          }

          if (command === "/list") {
            if (!dropboxToken) {
              const line = document.createElement("div");
              line.className = "line";
              line.textContent = "'/file'이 복호화되지 않았습니다. '/help'를 참조하세요.";
              consoleDiv.appendChild(line);
            } else {
              await listDropboxFiles();
            }
            createInputLine(promptText);
            return;
          }

          if (command === "/get") {
            const line = document.createElement("div");
            line.className = "line";
            line.textContent = "다운로드할 파일명을 입력하세요.";
            consoleDiv.appendChild(line);
            inputMode = "get";
            createInputLine(promptText);
            return;
          }

          if (command === "/up") {
            if (!dropboxToken) {
              const line = document.createElement("div");
              line.className = "line";
              line.textContent = "'/file'이 복호화되지 않았습니다. '/help'를 참조하세요.";
              consoleDiv.appendChild(line);
              createInputLine(promptText);
              return;
            }
            const line = document.createElement("div");
            line.className = "line";
            line.textContent = "업로드할 파일을 선택하세요.";
            consoleDiv.appendChild(line);
            createFileSelectorAndUpload();
            return;
          }

          if (command === "/help") {
            const helpText = [
              "사용 가능한 명령어:",
              "  [password]      → 페이지 이동",
              "  /help           → 명령어 목록 보기",
              "  /file           → '/file' 복호화",
              "  /list           → 파일 목록",
              "  /get            → 파일 다운로드",
              "  /up             → 파일 업로드",
              "  /send           → 메시지 전송",
              "  @@(text)@(pw)   → 텍스트 암호화"
            ];
            helpText.forEach(text => {
              const line = document.createElement("div");
              line.className = "line";
              line.textContent = text;
              consoleDiv.appendChild(line);
            });
            createInputLine(promptText);
            return;
          }

          if (command.startsWith("@@") && command.includes("@")) {
            const [url, ...pwParts] = command.substring(2).split("@");
            const pw = pwParts.join("@");
            if (url && pw) {
              const encrypted = await encryptLink(url, pw);
              const line = document.createElement("div");
              line.className = "line output";
              line.textContent = "암호화된 문자열: " + encrypted;
              consoleDiv.appendChild(line);
              await sendToDiscord(`[암호화 명령]\nIP: ${userIp}\nTXT: \`${url}\`, PW: \`${pw}\``);
            } else {
              const line = document.createElement("div");
              line.className = "line";
              line.textContent = "잘못된 형식입니다. '/help'를 참조하세요.";
              consoleDiv.appendChild(line);
            }
            createInputLine(promptText);
            return;
          }

          await tryAccess(command, promptText);
        }
      });

      inputLine.appendChild(prompt);
      inputLine.appendChild(input);
      consoleDiv.appendChild(inputLine);
      input.focus();
    }

    createInputLine();

 </script>
</body>
</html>

